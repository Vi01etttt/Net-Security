# WM9PD《Network Security》Session 7
## VPN、IPsec 与 ZTA（零信任架构）——中文翻译与总结

> 说明：本译稿依据上传课件的可提取文字内容整理，保留原有技术要点并做适度术语规范化。

---

## 1. 课程信息与学习目标
- **课程**：WM9PD: Network Security  
- **主题**：VPN, IPSEC and ZTA（VPN、IPsec 与零信任架构）  
- **授课教师**：Dr Hany Atlam（模块负责人）  
- **邮箱**：Hany.Atlam@warwick.ac.uk

**学习目标**：
- 理解 **VPN 基础**；
- 了解 **IPsec 协议族**；
- 理解 **Zero Trust Architecture（ZTA，零信任架构）**。

---

## 2. VPN 基础

### 2.1 背景：连接互联网与隐私问题
- 你上网时，计算机会先经过 ISP（运营商）作为网关；你的浏览、下载等流量都会经过它；因此 ISP **有能力监控并记录**你的在线活动。  
- **问题**：如何规避上述监控与隐私风险？

### 2.2 什么是 VPN
- VPN 在公共网络上，在两个端点之间建立**安全的加密隧道**；
- 隐匿你的 IP 地址，隐藏在线活动，提升隐私与匿名性；
- 主要目标：**保护隐私**。

### 2.3 VPN 的核心功能
- **机密性**（数据加密防拦截）；
- **完整性**（确保传输过程中未被篡改）；
- **鉴别**（确认通信双方身份）；
- **隐私**（隐藏真实身份/地址）；
- **突破地域限制**（绕过地理屏障）。

### 2.4 为什么使用 VPN（典型场景）
- **公网风险**：例如在咖啡馆 Wi‑Fi 嗅探明文 HTTP；
- **隐私与匿名**：隐藏 IP 并安全访问受地域限制内容；
- **业务连续性**：远程办公安全访问公司资源；
- **政府/涉密通信**：加密敏感信息交换。

### 2.5 VPN 如何工作（流程）
1) 用户发送数据；  
2) **封装** + **加密**；  
3) 加密后的数据包经“隧道”在公网传输；  
4) 目的端**解密**并**去封装**。

### 2.6 VPN 类型
- **站点到站点（Site‑to‑Site）**：把两个/多个网络长期安全互联；两端由**网关（路由器/防火墙）**处理加密；常用 **IPsec**；可扩展；如总部分支联网。
- **远程接入（Remote Access）**：个人用户按需接入；
  - **免客户端**：通过浏览器的安全连接；
  - **有客户端**：需安装客户端（如 WireGuard、AnyConnect）；  
  - 常用 **IPsec 或 TLS/SSL** 提供安全。

### 2.7 VPN 中的加密要素
- **密钥交换**：用**非对称加密**（如 RSA / DH）协商一次性会话密钥；
- **数据加密**：用**对称加密**（如 AES‑256）保护数据面；
- **完整性校验**：哈希（如 **SHA‑256**）验证未被篡改；
- **解密**：接收端使用会话密钥解密数据。

---

## 3. IPsec

### 3.1 IPsec 的动机与目标
- 标准的 IP **为路由设计**而非安全，报文可被拦截/读取/修改；
- **IPsec** 是一套用于保护 IP 通信的开放标准框架：对每个数据包进行**鉴别与加密**；
- 目标：**机密性、完整性、鉴别**。

### 3.2 IPsec 两大协议
- **AH（Authentication Header）**：提供**鉴别与完整性**；在 IP 头中加入加密哈希，**不提供加密**；
- **ESP（Encapsulating Security Payload）**：提供**加密、完整性、鉴别**，对**负载加密**并加入安全头/尾。

### 3.3 IPsec 两种模式
- **传输模式（Transport）**：保护**端到端主机**通信，只加密上层数据（IP 头保留用于路由）；
- **隧道模式（Tunnel）**：保护**网关对网关/网到网**，把**原始 IP 包（头+载荷）整体加密**，再加外层新 IP 头；如站点到站点 VPN。  
> AH 与 ESP 均可在两种模式中使用。

### 3.4 IKE 两阶段
- **Phase 1（密钥管理）**：用非对称算法（如 **Diffie‑Hellman**）建立安全协商通道，完成鉴别与会话密钥的安全分发；**仅建控道，不承载用户数据**；
- **Phase 2（数据传输）**：建立真正的数据隧道，用**对称加密**（如 AES）高效传输，通常由 **ESP** 保护负载。

### 3.5 实验活动（Lab）
- Lab 01：配置 **VPN 传输模式**；  
- Lab 02：配置 **VPN 隧道模式**；  
- Lab 03：**CLI** 下配置并验证 **站点到站点 IPsec**；  
- Lab 04：配置并验证 **站点到站点 IPsec**（向导/GUI 亦可）。

---

## 4. 零信任架构（ZTA）

### 4.1 传统“城堡与护城河”的问题
- 传统模式强调**边界防护**，**内网默认被信任**；一旦边界被突破，攻击者可**横向移动**；
- **零信任**：**不再假设任何“可信分区”**，默认“网络不可信”。

### 4.2 ZTA 定义与动机
- **定义**：无论内外部主体都**不被天然信任**，持续验证用户身份、设备健康与上下文；
- **核心原则**：**“Never trust, always verify.”（永不信任，持续验证）**；
- **意义**：缓解内鬼与横向移动风险，降低凭据/终端被攻陷的影响，适配**混合办公与云环境**。

### 4.3 ZTA 核心实践
1) **持续验证**：每次访问都验证；  
2) **最小权限**：仅授予完成任务所需最小权限；  
3) **微分段**：把网络切成小区域以**限制爆炸半径**；  
4) **上下文感知访问控制**：综合设备健康、地理位置、行为模式等实时因素决策。

### 4.4 “永不信任，总是验证”示例
- 即便一分钟前刚验证，也**必须重新鉴权与授权**；  
- **用户**：强认证/MFA；  
- **设备**：是否打补丁、是否开启防护；  
- **行为**：凌晨 3 点在异国访问异常文件？

### 4.5 最小权限与微分段
- 仅授予岗位所需**最低权限**；  
- 通过**微分段**隔离系统与数据，分区独立防护，避免单点沦陷后蔓延。

### 4.6 设备健康与合规
- 接入前检查：是否受管、杀软是否实时/最新、系统是否打补丁、**磁盘是否加密**；  
- **条件式访问**：只有满足最低健康标准才授予访问；姿态变差则**立即收回**。

### 4.7 ZTA 落地工具（不是单一产品）
- **IAM**：MFA、基于角色的访问控制；  
- **端点安全**：确保设备合规；  
- **网络微分段**：隔离被攻陷区域；  
- **威胁情报联动**：利用全球情报动态更新策略；  
- **结论**：**ZTA 不是“买来”的**，而是**按其原则组合多工具去构建**。

---

## 5. 一页纸速查总结（Cheat Sheet）
- **VPN**：在公网建立加密隧道；类型含 Site‑to‑Site 与 Remote Access；客户端/免客户端均可；安全多由 **IPsec或TLS/SSL** 提供。  
- **IPsec 协议**：**AH**（鉴别+完整性）与 **ESP**（加密+完整性+鉴别）；**Transport** vs **Tunnel** 模式；**IKE P1** 建控道、**P2** 建数据隧道。  
- **ZTA 原则**：**持续验证**、**最小权限**、**微分段**、**上下文感知访问**；检查**设备姿态**并以**条件式访问**强制合规；**ZTA 是框架，不是产品**。

# 高层摘要（200字内）
课程讲解了 VPN 的动机与工作机理（封装+加密+隧道）、两类应用（站点到站点/远程接入）及其加密要素；系统阐述了 IPsec 的目标（机密性/完整性/鉴别）、两大协议（AH/ESP）、两种模式（传输/隧道）与 IKE 两阶段；实验部分涵盖传输/隧道模式与站点到站点配置与验证。零信任部分从“城堡‑护城河”的弊端出发，提出“永不信任，持续验证”，强调最小权限、微分段、设备健康与上下文感知访问，并指出 ZTA 是战略框架、需以多工具协同落地。